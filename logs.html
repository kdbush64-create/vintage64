<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>vintage64 | Business Logs</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body class="terminal">
    <div class="container">
        <header>
            <h1>[ VINTAGE_64_SYSTEM_LOGS ]</h1>
            <nav><a href="index.html">HOME</a> | <a href="logs.html">LOGS</a></nav>
        </header>
        <hr class="divider">
        <div id="log-container"><p class="blink">SCANNING_REPOSITORIES...</p></div>
        <footer>
            <hr class="divider">
            <p>&copy; 2026 VINTAGE64 | STATUS: ONLINE</p>
        </footer>
    </div>

    <script>
        async function loadLogs() {
            const container = document.getElementById('log-container');
            // UPDATE THESE TWO LINES TO MATCH YOUR GITHUB EXACTLY
            const user = "kdbush64-create"; 
            const repo = "vintage64"; 
            
            try {
                const response = await fetch(`https://api.github.com/repos/${user}/${repo}/contents/business-logs`);
                const files = await response.json();
                container.innerHTML = ''; 

                // Get all .md files, newest first
                const mdFiles = files.filter(f => f.name.endsWith('.md')).reverse();

                for (let file of mdFiles) {
                    const res = await fetch(file.download_url);
                    const content = await res.text();

                    // Logic to find the Title and Date between the dashes
                    const parts = content.split('---');
                    let displayTitle = file.name;
                    let displayDate = "";
                    let body = content;

                    if (parts.length >= 3) {
                        const header = parts[1];
                        body = parts.slice(2).join('---');
                        const tMatch = header.match(/title:\s*(.*)/);
                        const dMatch = header.match(/date:\s*(.*)/);
                        if (tMatch) displayTitle = tMatch[1];
                        if (dMatch) displayDate = dMatch[1];
                    }

                    const entry = document.createElement('div');
                    entry.className = 'log-entry';
                    entry.innerHTML = `
                        <h3 style="color: #33ff33;">> ${displayTitle} [${displayDate}]</h3>
                        <div class="log-body">${marked.parse(body)}</div>
                        <hr style="border: 1px dashed #33ff33; opacity: 0.2; margin: 20px 0;">
                    `;
                    container.appendChild(entry);
                }
            } catch (e) {
                container.innerHTML = '<p>ERROR: UPLINK_FAILURE</p>';
            }
        }
        loadLogs();
    </script>
</body>
</html>
